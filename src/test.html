<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Leanplum WebSDK Demo</title>
</head>

<body>
  <div id="app" style="display: none;">
    <button id="testButton">Test</button>
    <button id="stopButton">Stop</button>
  </div>

  <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
    integrity="sha256-pasqAKBDmFT4eHoN2ndd6lN370kFiGUFyTiUHWhU7k8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/leanplum-sdk@1.4.0/dist/leanplum.min.js"></script>

  <script>
    // This value should be set to true only if you're developing on your server.
    var isDevelopmentMode = true;

    // Sample variables. This can be any JSON object.
    var variables = {
      items: {
        color: 'red',
        size: 20,
        showBadges: true
      },
      showAds: true
    };

    // Get your App ID and Keys from https://www.leanplum.com/dashboard?#/account/apps
    if (isDevelopmentMode) {
      Leanplum.setAppIdForDevelopmentMode(
        "app_1R68vJaFq0XfKjH7PO6wllqZONbbqT2RML5LgLelGaE",
        "dev_CjLbQGjQO748Gm6LY14rJPT3IrQeYwAljJcYZHaA5Mg"
      );
    } else {
      Leanplum.setAppIdForProductionMode(
        "app_1R68vJaFq0XfKjH7PO6wllqZONbbqT2RML5LgLelGaE",
        "prod_kiHEN9pOAbDGhPhKsrTHwZNniYMDd7nkZ7b5J7OLPQg"
      );
    }

    Leanplum.addVariablesChangedHandler(onVariablesUpdate);

    updateUI(variables);
    Leanplum.setVariables(variables);
    Leanplum.start(function(success) {
      var vars = Leanplum.getVariables();
      console.log('Success: ' + success);
      console.log('Variables', vars);
      console.log('Color', Leanplum.getVariable('items', 'color'));
      console.log('ShowBadges', Leanplum.getVariable('items', 'showBadges'));
      console.log('ShowAds', Leanplum.getVariable('showAds'));
      updateUI(vars);
    });

    $('#stopButton').click(function() {
      Leanplum.removeVariablesChangedHandler(onVariablesUpdate);
    });

    function onVariablesUpdate() {
      var vars = Leanplum.getVariables();
      console.log('Variables updated!', vars);
      updateUI(vars);
    }

    function updateUI(variables) {
      $('#testButton').css({ backgroundColor: variables.items.color });
      $('#app').show();
    }

    // Leanplum.setVariables({
    //   StoreTitle: "Powerup Store",
    //   Items: [
    //     {
    //       name: "Speed Boost",
    //       price: 100
    //     }, {
    //       name: "Health Boost",
    //       price: 150
    //     }
    //   ]
    // });

    // var variables = Leanplum.getVariables();
    // //Gets a particular variable.
    // var title = Leanplum.getVariable('StoreTitle');
    // var speedBoost = Leanplum.getVariable('Items', 0);
    // var healthBoostName = Leanplum.getVariable('Items', 1, 'name');
  </script>

</body>

</html>
