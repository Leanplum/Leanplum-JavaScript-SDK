!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Leanplum=e():t.Leanplum=e()}(window,function(){return r={},o.m=n=[function(t,e,n){var r=n(18),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();t.exports=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={METHODS:{START:"start",STOP:"stop",ADVANCE:"advance",TRACK:"track",PAUSE_SESSION:"pauseSession",RESUME_SESSION:"resumeSession",PAUSE_STATE:"pauseState",RESUME_STATE:"resumeState",DOWNLOAD_FILE:"downloadFile",MULTI:"multi",SET_VARS:"setVars",GET_VARS:"getVars",SET_USER_ATTRIBUTES:"setUserAttributes",SET_DEVICE_ATTRIBUTES:"setDeviceAttributes",UPLOAD_FILE:"uploadFile",REGISTER_DEVICE:"registerDevice"},SDK_VERSION:"1.4.0",CLIENT:"js",PARAMS:{ACTION:"action",APP_ID:"appId",CLIENT:"client",CLIENT_KEY:"clientKey",DEVICE_ID:"deviceId",SDK_VERSION:"sdkVersion",USER_ID:"userId",NEW_USER_ID:"newUserId",DEV_MODE:"devMode",VERSION_NAME:"versionName",SYSTEM_NAME:"systemName",SYSTEM_VERSION:"systemVersion",BROWSER_NAME:"browserName",BROWSER_VERSION:"browserVersion",DEVICE_NAME:"deviceName",DEVICE_MODEL:"deviceModel",USER_ATTRIBUTES:"userAttributes",LOCALE:"locale",COUNTRY:"country",REGION:"region",CITY:"city",LOCATION:"location",STATE:"state",INFO:"info",EVENT:"event",VALUE:"value",FILENAME:"filename",TIME:"time",DATA:"data",VARS:"vars",FILE:"file",SIZE:"size",VARIATION:"variation",HASH:"hash",EMAIL:"email",VARIABLES:"vars",PARAMS:"params",INCLUDE_DEFAULTS:"includeDefaults",INCLUDE_VARIANT_DEBUG_INFO:"includeVariantDebugInfo",WEB_PUSH_SUBSCRIPTION:"webPushSubscription"},KEYS:{IS_REGISTERED:"isRegistered",LATEST_VERSION:"latestVersion",VARS:"vars",VARIANTS:"variants",VARIANT_DEBUG_INFO:"variantDebugInfo",ACTION_METADATA:"actionMetadata",TOKEN:"token"},DEFAULT_KEYS:{COUNT:"__leanplum_unsynced",ITEM:"__leanplum_unsynced_",VARIABLES:"__leanplum_variables",VARIANTS:"__leanplum_variants",VARIANT_DEBUG_INFO:"__leanplum_variant_debug_info",ACTION_METADATA:"__leanplum_action_metadata",TOKEN:"__leanplum_token",DEVICE_ID:"__leanplum_device_id",USER_ID:"__leanplum_user_id",PUSH_SUBSCRIPTION:"__leanplum_push_subscription"},VALUES:{DETECT:"(detect)"}}},function(t,e,n){var r=n(47),o=n(53);t.exports=function(t,e){var n=o(t,e);return r(n)?n:void 0}},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=r(n(1)),i=(s.prototype.add=function(t,e){return void 0===e||(this.argString&&(this.argString+="&"),this.argString+=t+"="+encodeURIComponent(e),this.argValues[t]=e),this},s.prototype.body=function(t){return t?(this._body=t,this):this._body},s.prototype.attachApiKeys=function(t,e){return this.add(o.default.PARAMS.APP_ID,t).add(o.default.PARAMS.CLIENT,o.default.CLIENT).add(o.default.PARAMS.CLIENT_KEY,e)},s.prototype.build=function(){return this.argString},s.prototype.buildDict=function(){return this.argValues},s);function s(){this.argString="",this.argValues={}}e.default=i},function(t,e,n){"use strict";var r;Object.defineProperty(e,"__esModule",{value:!0});var o={},i=(s.getFromLocalStorage=function(t){return!1===r?o[t]:localStorage[t]},s.saveToLocalStorage=function(e,n){if(!1!==r)try{localStorage[e]=n}catch(t){r=!1,o[e]=n}else o[e]=n},s.removeFromLocalStorage=function(e){if(!1!==r)try{localStorage.removeItem(e)}catch(t){r=!1,delete o[e]}else delete o[e]},s);function s(){}e.default=i},function(t,e,n){var r=n(37),o=n(38),i=n(39),s=n(40),a=n(41);function u(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=i,u.prototype.has=s,u.prototype.set=a,t.exports=u},function(t,e,n){var r=n(16);t.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return-1}},function(t,e,n){var r=n(12),o=n(49),i=n(50),s=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":(s&&s in Object(t)?o:i)(t)}},function(t,e,n){var r=n(2)(Object,"create");t.exports=r},function(t,e,n){var r=n(62);t.exports=function(t,e){var n=t.__data__;return r(e)?n["string"==typeof e?"string":"hash"]:n.map}},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e,n){var r=n(2)(n(0),"Map");t.exports=r},function(t,e,n){var r=n(0).Symbol;t.exports=r},function(t,e){var n=Array.isArray;t.exports=n},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=(o.prototype.setNetworkTimeout=function(t){this.networkTimeoutSeconds=t},o.prototype.ajax=function(t,e,n,r,o,i,s){var a=this;if(i){if(this.runningRequest)return this.enqueueRequest(arguments);this.runningRequest=!0}if("undefined"!=typeof XDomainRequest)return"http:"===location.protocol&&0===e.indexOf("https:")&&(e="http:"+e.substring(6)),this.ajaxIE8.call(this,arguments);var u=!1,c=new XMLHttpRequest;c.onreadystatechange=function(){if(4===c.readyState){if(u)return;var t,e=!(u=!0);if(s)t=c.responseText;else try{t=JSON.parse(c.responseText)}catch(t){setTimeout(function(){o&&o(null,c)},0),e=!0}e||(200<=c.status&&c.status<300?setTimeout(function(){r&&r(t,c)},0):setTimeout(function(){o&&o(t,c)},0)),i&&(a.runningRequest=!1,a.dequeueRequest())}},c.open(t,e,!0),c.setRequestHeader("Content-Type","text/plain"),c.send(n),setTimeout(function(){u||c.abort()},1e3*this.networkTimeoutSeconds)},o.prototype.ajaxIE8=function(t,e,n,r,o,i,s){var a=this,u=new XDomainRequest;u.onload=function(){var t,e=!1;if(s)t=u.responseText;else try{t=JSON.parse(u.responseText)}catch(t){setTimeout(function(){o&&o(null,u)},0),e=!0}e||setTimeout(function(){r&&r(t,u)},0),i&&(a.runningRequest=!1,a.dequeueRequest())},u.onerror=u.ontimeout=function(){setTimeout(function(){o&&o(null,u)},0),i&&(a.runningRequest=!1,a.dequeueRequest())},u.onprogress=function(){},u.open(t,e),u.timeout=1e3*this.networkTimeoutSeconds,u.send(n)},o.prototype.enqueueRequest=function(t){this.requestQueue.push(t)},o.prototype.dequeueRequest=function(){var t=this.requestQueue.shift();t&&this.ajax.call(this,t)},o);function o(){this.networkTimeoutSeconds=10,this.requestQueue=[],this.runningRequest=!1}e.default=r},function(t,e,n){var r=n(34);t.exports=function(t,e){return r(t,e)}},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e,n){var r=n(7),o=n(19);t.exports=function(t){if(!o(t))return!1;var e=r(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},function(n,t,e){(function(t){var e="object"==typeof t&&t&&t.Object===Object&&t;n.exports=e}).call(this,e(48))},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e){var n=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return n.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,e,n){var r=n(54),o=n(61),i=n(63),s=n(64),a=n(65);function u(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=i,u.prototype.has=s,u.prototype.set=a,t.exports=u},function(t,e,n){var _=n(66),S=n(69),b=n(70);t.exports=function(t,e,n,r,o,i){var s=1&n,a=t.length,u=e.length;if(a!=u&&!(s&&a<u))return!1;var c=i.get(t);if(c&&i.get(e))return c==e;var l=-1,f=!0,p=2&n?new _:void 0;for(i.set(t,e),i.set(e,t);++l<a;){var d=t[l],h=e[l];if(r)var v=s?r(h,d,l,e,t,i):r(d,h,l,t,e,i);if(void 0!==v){if(v)continue;f=!1;break}if(p){if(!S(e,function(t,e){if(!b(p,e)&&(d===t||o(d,t,n,r,i)))return p.push(e)})){f=!1;break}}else if(d!==h&&!o(d,h,n,r,i)){f=!1;break}}return i.delete(t),i.delete(e),f}},function(t,a,u){(function(t){var e=u(0),n=u(87),r=a&&!a.nodeType&&a,o=r&&"object"==typeof t&&t&&!t.nodeType&&t,i=o&&o.exports===r?e.Buffer:void 0,s=(i?i.isBuffer:void 0)||n;t.exports=s}).call(this,u(24)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){var r=n(89),o=n(90),i=n(91),s=i&&i.isTypedArray,a=s?o(s):r;t.exports=a},function(t,e){t.exports=function(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=9007199254740991}},function(t,e,n){var r=n(28);t.exports=r.default},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=r(n(29)),i=(s.setApiPath=function(t){s._lp.setApiPath(t)},s.setEmail=function(t){s._lp.setEmail(t)},s.setNetworkTimeout=function(t){s._lp.setNetworkTimeout(t)},s.setAppIdForDevelopmentMode=function(t,e){s._lp.setAppIdForDevelopmentMode(t,e)},s.setAppIdForProductionMode=function(t,e){s._lp.setAppIdForProductionMode(t,e)},s.setSocketHost=function(t){s._lp.setSocketHost(t)},s.setDeviceId=function(t){s._lp.setDeviceId(t)},s.setAppVersion=function(t){s._lp.setAppVersion(t)},s.setDeviceName=function(t){s._lp.setDeviceName(t)},s.setDeviceModel=function(t){s._lp.setDeviceModel(t)},s.setRequestBatching=function(t,e){s._lp.setRequestBatching(t,e)},s.setSystemName=function(t){s._lp.setSystemName(t)},s.setSystemVersion=function(t){s._lp.setSystemVersion(t)},s.setVariables=function(t){s._lp.setVariables(t)},s.setVariantDebugInfoEnabled=function(t){s._lp.setVariantDebugInfoEnabled(t)},s.getVariantDebugInfo=function(){return s._lp.getVariantDebugInfo()},s.getVariables=function(){return s._lp.getVariables()},s.getVariable=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return(t=s._lp).getVariable.apply(t,e)},s.getVariants=function(){return s._lp.getVariants()},s.addStartResponseHandler=function(t){s._lp.addStartResponseHandler(t)},s.removeStartResponseHandler=function(t){s._lp.removeStartResponseHandler(t)},s.addVariablesChangedHandler=function(t){s._lp.addVariablesChangedHandler(t)},s.removeVariablesChangedHandler=function(t){s._lp.removeVariablesChangedHandler(t)},s.forceContentUpdate=function(t){s._lp.forceContentUpdate(t)},s.start=function(t,e,n){s._lp.start(t,e,n)},s.startFromCache=function(t,e,n){s._lp.startFromCache(t,e,n)},s.stop=function(){s._lp.stop()},s.pauseSession=function(){s._lp.pauseSession()},s.resumeSession=function(){s._lp.resumeSession()},s.pauseState=function(){s._lp.pauseState()},s.resumeState=function(){s._lp.resumeState()},s.setUserId=function(t){s.setUserAttributes(t)},s.setUserAttributes=function(t,e){s._lp.setUserAttributes(t,e)},s.track=function(t,e,n,r){s._lp.track(t,e,n,r)},s.trackPurchase=function(t,e,n,r){void 0===r&&(r="Purchase"),s._lp.trackPurchase(t,e,n,r)},s.advanceTo=function(t,e,n){s._lp.advanceTo(t,e,n)},s.isWebPushSupported=function(){return s._lp.isWebPushSupported()},s.isWebPushSubscribed=function(){return s._lp.isWebPushSubscribed()},s.registerForWebPush=function(t){return s._lp.registerForWebPush(t)},s.unregisterFromWebPush=function(){return s._lp.unregisterFromWebPush()},s.clearUserContent=function(){s._lp.clearUserContent()},s.__destroy=function(){this._lp=new o.default(window)},s._lp=new o.default(window),s);function s(){}e.default=i},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=o(n(3)),s=o(n(30)),a=o(n(1)),u=o(n(31)),c=o(n(32)),l=o(n(33)),f=o(n(4)),p=o(n(103)),d=o(n(104)),h=(v.prototype.setApiPath=function(t){this._lpRequest.apiPath&&(this._lpRequest.apiPath=t)},v.prototype.setEmail=function(t){this._email=t},v.prototype.setNetworkTimeout=function(t){this._lpRequest.setNetworkTimeout(t),this._lpSocket.setNetworkTimeout(t)},v.prototype.setAppIdForDevelopmentMode=function(t,e){this._lpRequest.appId=t,this._lpRequest.clientKey=e,this._internalState.devMode=!0},v.prototype.setAppIdForProductionMode=function(t,e){this._lpRequest.appId=t,this._lpRequest.clientKey=e,this._internalState.devMode=!1},v.prototype.setSocketHost=function(t){this._lpSocket.setSocketHost(t)},v.prototype.setDeviceId=function(t){this._lpRequest.deviceId=t},v.prototype.setAppVersion=function(t){this._lpRequest.versionName=t},v.prototype.setDeviceName=function(t){this._deviceName=t},v.prototype.setDeviceModel=function(t){this._deviceModel=t},v.prototype.setRequestBatching=function(t,e){this._lpRequest.batchEnabled=t,this._lpRequest.batchCooldown=e},v.prototype.setSystemName=function(t){this._systemName=t},v.prototype.setSystemVersion=function(t){this._systemVersion=t},v.prototype.setVariables=function(t){this._varCache.setVariables(t)},v.prototype.setVariantDebugInfoEnabled=function(t){this._internalState.variantDebugInfoEnabled=t},v.prototype.getVariantDebugInfo=function(){return this._varCache.getVariantDebugInfo()},v.prototype.getVariables=function(){return this._varCache.getVariables()},v.prototype.getVariable=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return(t=this._varCache).getVariable.apply(t,e)},v.prototype.getVariants=function(){return this._varCache.variants||[]},v.prototype.addStartResponseHandler=function(t){this._internalState.addStartResponseHandler(t)},v.prototype.removeStartResponseHandler=function(t){this._internalState.removeStartResponseHandler(t)},v.prototype.addVariablesChangedHandler=function(t){this._varCache.addVariablesChangedHandler(t)},v.prototype.removeVariablesChangedHandler=function(t){this._varCache.removeVariablesChangedHandler(t)},v.prototype.forceContentUpdate=function(r){var o=this,t=(new i.default).add(a.default.PARAMS.INCLUDE_DEFAULTS,!1).add(a.default.PARAMS.INCLUDE_VARIANT_DEBUG_INFO,this._internalState.variantDebugInfoEnabled);this.createRequest(a.default.METHODS.GET_VARS,t,{queued:!1,sendNow:!0,response:function(t){var e=o._lpRequest.getLastResponse(t),n=o._lpRequest.isResponseSuccess(e);n&&(o._varCache.applyDiffs(e[a.default.KEYS.VARS],e[a.default.KEYS.VARIANTS],e[a.default.KEYS.ACTION_METADATA]),o._varCache.setVariantDebugInfo(e[a.default.KEYS.VARIANT_DEBUG_INFO])),r&&r(n)}})},v.prototype.start=function(t,e,n){var r=this;"function"==typeof t?(n=t,e={},t=null):"object"==typeof t&&null!=t?(n=e,e=t,t=null):"function"==typeof e&&(n=e,e={}),this._lpRequest.userId=t,n&&this.addStartResponseHandler(n),this._varCache.onUpdate=function(){r._varCache.triggerVariablesChangedHandlers()};var o=(new i.default).add(a.default.PARAMS.USER_ATTRIBUTES,JSON.stringify(e)).add(a.default.PARAMS.COUNTRY,a.default.VALUES.DETECT).add(a.default.PARAMS.REGION,a.default.VALUES.DETECT).add(a.default.PARAMS.CITY,a.default.VALUES.DETECT).add(a.default.PARAMS.LOCATION,a.default.VALUES.DETECT).add(a.default.PARAMS.SYSTEM_NAME,this._systemName||this._browserDetector.OS).add(a.default.PARAMS.SYSTEM_VERSION,(this._systemVersion||"").toString()).add(a.default.PARAMS.BROWSER_NAME,this._browserDetector.browser).add(a.default.PARAMS.BROWSER_VERSION,this._browserDetector.version.toString()).add(a.default.PARAMS.LOCALE,a.default.VALUES.DETECT).add(a.default.PARAMS.DEVICE_NAME,this._deviceName||this._browserDetector.browser+" "+this._browserDetector.version).add(a.default.PARAMS.DEVICE_MODEL,this._deviceModel||"Web Browser").add(a.default.PARAMS.INCLUDE_DEFAULTS,!1).add(a.default.PARAMS.INCLUDE_VARIANT_DEBUG_INFO,this._internalState.variantDebugInfoEnabled);this.createRequest(a.default.METHODS.START,o,{queued:!0,sendNow:!0,response:function(t){r._internalState.hasStarted=!0;var e=r._lpRequest.getLastResponse(t);if(r._lpRequest.isResponseSuccess(e)){if(r._internalState.startSuccessful=!0,r._internalState.devMode){var n=e[a.default.KEYS.LATEST_VERSION];n&&console.log("A newer version of Leanplum, "+n+', is available.\nUse "npm update leanplum-sdk" or go to https://docs.leanplum.com/reference#javascript-setup to download it.'),r.connectSocket()}r._varCache.applyDiffs(e[a.default.KEYS.VARS],e[a.default.KEYS.VARIANTS],e[a.default.KEYS.ACTION_METADATA]),r._varCache.setVariantDebugInfo(e[a.default.KEYS.VARIANT_DEBUG_INFO]),r._varCache.token=e[a.default.KEYS.TOKEN]}else r._internalState.startSuccessful=!1,r._varCache.loadDiffs();r._internalState.triggerStartHandlers()}})},v.prototype.startFromCache=function(t,e,n){"function"==typeof t?(n=t,e={},t=null):"object"==typeof t&&null!=t?(n=e,e=t,t=null):"function"==typeof e&&(n=e,e={}),this._lpRequest.userId=t,n&&this.addStartResponseHandler(n),this._internalState.hasStarted=!0,this._internalState.startSuccessful=!0,this._internalState.devMode&&this.connectSocket(),this._varCache.loadDiffs(),this._internalState.triggerStartHandlers()},v.prototype.stop=function(){this.createRequest(a.default.METHODS.STOP,void 0,{sendNow:!0,queued:!0})},v.prototype.pauseSession=function(){this.createRequest(a.default.METHODS.PAUSE_SESSION,void 0,{sendNow:!0,queued:!0})},v.prototype.resumeSession=function(){this.createRequest(a.default.METHODS.RESUME_SESSION,void 0,{sendNow:!0,queued:!0})},v.prototype.pauseState=function(){this.createRequest(a.default.METHODS.PAUSE_STATE,void 0,{queued:!0})},v.prototype.resumeState=function(){this.createRequest(a.default.METHODS.RESUME_STATE,void 0,{queued:!0})},v.prototype.setUserId=function(t){this.setUserAttributes(t)},v.prototype.setUserAttributes=function(t,e){if(void 0===e)if("object"==typeof t)e=t,t=void 0;else if("string"!=typeof t)return void console.log("Leanplum: setUserAttributes expects a string or an object");var n=(new i.default).add(a.default.PARAMS.USER_ATTRIBUTES,e?JSON.stringify(e):void 0).add(a.default.PARAMS.NEW_USER_ID,t);this.createRequest(a.default.METHODS.SET_USER_ATTRIBUTES,n,{queued:!0}),t&&(this._lpRequest.userId=t,f.default.saveToLocalStorage(a.default.DEFAULT_KEYS.USER_ID,this._lpRequest.userId))},v.prototype.track=function(t,e,n,r){"object"==typeof e&&null!=e?(r=e,e=n=void 0):"string"==typeof e?(r=n,n=e,e=void 0):"object"==typeof n&&null!=n&&(r=n,n=void 0);var o=(new i.default).add(a.default.PARAMS.EVENT,t).add(a.default.PARAMS.VALUE,e||0).add(a.default.PARAMS.INFO,n).add(a.default.PARAMS.PARAMS,JSON.stringify(r));this.createRequest(a.default.METHODS.TRACK,o,{queued:!0})},v.prototype.trackPurchase=function(t,e,n,r){void 0===r&&(r="Purchase");var o=n;e&&(o=Object.assign({},n,{currencyCode:e})),this.track(r,t,o)},v.prototype.advanceTo=function(t,e,n){"object"==typeof e&&null!=e&&(n=e,e=void 0);var r=(new i.default).add(a.default.PARAMS.STATE,t).add(a.default.PARAMS.INFO,e).add(a.default.PARAMS.PARAMS,JSON.stringify(n));this.createRequest(a.default.METHODS.ADVANCE,r,{queued:!0})},v.prototype.isWebPushSupported=function(){return this._pushManager.isWebPushSupported()},v.prototype.isWebPushSubscribed=function(){return this._pushManager.isWebPushSubscribed()},v.prototype.registerForWebPush=function(t){var e=this;return this._pushManager.isWebPushSupported()?this._pushManager.register(t,function(t){return t?Promise.resolve(!0):e._pushManager.subscribeUser()}):Promise.reject("Leanplum: WebPush is not supported.")},v.prototype.unregisterFromWebPush=function(){return this._pushManager.unsubscribeUser()},v.prototype.clearUserContent=function(){this._varCache.clearUserContent()},v.prototype.createRequest=function(t,e,n){void 0===n&&(n={}),this._lpRequest.request(t,e,r({devMode:this._internalState.devMode},n))},v.prototype.connectSocket=function(){this._lpSocket.connect(this._varCache,{appId:this._lpRequest.appId,deviceId:this._lpRequest.deviceId},this.createRequest,this._lpRequest.getLastResponse)},v);function v(t){this._internalState=new u.default,this._lpRequest=new c.default,this._lpSocket=new l.default,this._pushManager=new p.default(this.createRequest.bind(this)),this._varCache=new d.default(this.createRequest.bind(this)),this._browserDetector=new s.default(t)}e.default=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=(o.prototype.searchString=function(t){for(var e=0;e<t.length;e++){var n=t[e].string,r=t[e].prop;if(this.versionSearchString=t[e].versionSearch||t[e].identity,n){if(-1!==n.indexOf(t[e].subString))return t[e].identity}else if(r)return t[e].identity}},o.prototype.searchVersion=function(t){if(t){var e=t.indexOf(this.versionSearchString);if(-1!==e)return parseFloat(t.substring(e+this.versionSearchString.length+1))}},o.prototype.getBrowserData=function(t){return[{string:t.navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:t.navigator.userAgent,subString:"OmniWeb",identity:"OmniWeb",versionSearch:"OmniWeb/"},{string:t.navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:t.opera,identity:"Opera",versionSearch:"Version"},{string:t.navigator.vendor,subString:"iCab",identity:"iCab"},{string:t.navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:t.navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:t.navigator.vendor,subString:"Camino",identity:"Camino"},{string:t.navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:t.navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:t.navigator.userAgent,subString:"Android",identity:"Android Browser",versionSearch:"Version"},{string:t.navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:t.navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}]},o.prototype.getOSData=function(t){return[{string:t.navigator.platform,subString:"Win",identity:"Windows"},{string:t.navigator.platform,subString:"Mac",identity:"Mac OS"},{string:t.navigator.userAgent,subString:"iPhone",identity:"iOS"},{string:t.navigator.userAgent,subString:"Android",identity:"Android"},{string:t.navigator.platform,subString:"Linux",identity:"Linux"}]},o);function o(t){this.browser=this.searchString(this.getBrowserData(t))||"Unknown Browser",this.version=this.searchVersion(t.navigator.userAgent)||this.searchVersion(t.navigator.appVersion)||"Unknown Version",this.OS=this.searchString(this.getOSData(t))||"Unknown OS"}e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=(o.prototype.addStartResponseHandler=function(t){this.startHandlers.push(t),this.hasStarted&&t(this.startSuccessful)},o.prototype.removeStartResponseHandler=function(t){var e=this.startHandlers.indexOf(t);0<=e&&this.startHandlers.splice(e,1)},o.prototype.triggerStartHandlers=function(){for(var t=0;t<this.startHandlers.length;t++)this.startHandlers[t](this.startSuccessful)},o);function o(){this.startHandlers=[],this.devMode=!1,this.hasStarted=!1,this.startSuccessful=!1,this.variantDebugInfoEnabled=!1}e.default=r},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var h=r(n(3)),v=r(n(1)),o=r(n(4)),i=r(n(14)),s=(a.prototype.request=function(t,e,r){var o=this;if(void 0===r&&(r={}),r=r||{},e=e||new h.default,this.deviceId||(this.deviceId=this.loadLocal(v.default.DEFAULT_KEYS.DEVICE_ID)),!this.deviceId){for(var n="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",s=0;s<16;s++)n+=i.charAt(Math.floor(Math.random()*i.length));this.deviceId=n,this.saveLocal(v.default.DEFAULT_KEYS.DEVICE_ID,n)}this.userId||(this.userId=this.loadLocal(v.default.DEFAULT_KEYS.USER_ID),this.userId||(this.userId=this.deviceId)),this.saveLocal(v.default.DEFAULT_KEYS.USER_ID,this.userId);var a=e.attachApiKeys(this.appId,this.clientKey).add(v.default.PARAMS.SDK_VERSION,v.default.SDK_VERSION).add(v.default.PARAMS.DEVICE_ID,this.deviceId).add(v.default.PARAMS.USER_ID,this.userId).add(v.default.PARAMS.ACTION,t).add(v.default.PARAMS.VERSION_NAME,this.versionName).add(v.default.PARAMS.DEV_MODE,r.devMode).add(v.default.PARAMS.TIME,((new Date).getTime()/1e3).toString()),u=r.success||r.response,c=r.error||r.response;if(!this.appId||!this.clientKey){var l="Leanplum App ID and client key are not set. Make sure you are calling setAppIdForDevelopmentMode or setAppIdForProductionMode before issuing API calls.";return console.error(l),void(c&&c(l))}if(e.body())this.network.ajax("POST",this.apiPath+"?"+a.build(),e.body(),u,c,r.queued);else{var f=r.devMode||r.sendNow||!this.batchEnabled,p=function(){var t=o.popUnsentRequests();if(0<t.length){var e=JSON.stringify({data:t}),n=(new h.default).attachApiKeys(o.appId,o.clientKey).add(v.default.PARAMS.SDK_VERSION,v.default.SDK_VERSION).add(v.default.PARAMS.ACTION,v.default.METHODS.MULTI).add(v.default.PARAMS.TIME,((new Date).getTime()/1e3).toString().toString()).build();o.network.ajax("POST",o.apiPath+"?"+n,e,u,c,r.queued)}};if(!f&&this.batchCooldown){var d=(new Date).getTime()/1e3;!this.lastRequestTime||d-this.lastRequestTime>=this.batchCooldown?(f=!0,this.lastRequestTime=d):this.cooldownTimeout||(this.cooldownTimeout=setTimeout(function(){o.cooldownTimeout=null,o.lastRequestTime=(new Date).getTime()/1e3,p()},1e3*(this.batchCooldown-(d-this.lastRequestTime))))}this.saveRequestForLater(a.buildDict()),f&&p()}},a.prototype.setNetworkTimeout=function(t){this.network.setNetworkTimeout(t)},a.prototype.getLastResponse=function(t){var e,n,r,o=null!=(n=null===(e=null==t?void 0:t.response)||void 0===e?void 0:e.length)?n:0;return 0<o?null===(r=null==t?void 0:t.response)||void 0===r?void 0:r[o-1]:null},a.prototype.isResponseSuccess=function(t){return Boolean(null==t?void 0:t.success)},a.prototype.saveRequestForLater=function(t){var e=this.loadLocal(v.default.DEFAULT_KEYS.COUNT)||0,n=v.default.DEFAULT_KEYS.ITEM+e;this.saveLocal(n,JSON.stringify(t)),e++,this.saveLocal(v.default.DEFAULT_KEYS.COUNT,e)},a.prototype.popUnsentRequests=function(){var t=[],e=this.loadLocal(v.default.DEFAULT_KEYS.COUNT)||0;this.removeLocal(v.default.DEFAULT_KEYS.COUNT);for(var n=0;n<e;n++){var r=v.default.DEFAULT_KEYS.ITEM+n;try{t.push(JSON.parse(this.loadLocal(r)))}catch(t){}this.removeLocal(r)}return t},a.prototype.loadLocal=function(t){return o.default.getFromLocalStorage(t)},a.prototype.saveLocal=function(t,e){o.default.saveToLocalStorage(t,e)},a.prototype.removeLocal=function(t){o.default.removeFromLocalStorage(t)},a);function a(){this.cooldownTimeout=null,this.lastRequestTime=void 0,this.network=new i.default,this.apiPath="https://www.leanplum.com/api",this.batchCooldown=5,this.batchEnabled=!0}e.default=s},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=r(n(15)),u=r(n(3)),c=r(n(1)),l=r(n(102)),o=(i.prototype.connect=function(i,e,r,s){var o=this;if(WebSocket){var n=!1;this.socketClient=new l.default,this.socketClient.setNetworkTimeout(this.networkTimeoutSeconds),this.socketClient.onopen=function(){var t;n||(console.log("Leanplum: Connected to development server."),o.socketClient.send("auth",((t={})[c.default.PARAMS.APP_ID]=e.appId,t[c.default.PARAMS.DEVICE_ID]=e.deviceId,t)),n=!0)},this.socketClient.onerror=function(t){console.log("Leanplum: Socket error",t)},this.socketClient.onmessage=function(t,e){if("updateVars"===t){var n=(new u.default).add(c.default.PARAMS.INCLUDE_DEFAULTS,!1);r(c.default.METHODS.GET_VARS,n,{queued:!1,sendNow:!0,response:function(t){var e=s(t),n=e[c.default.KEYS.VARS],r=e[c.default.KEYS.VARIANTS],o=e[c.default.KEYS.ACTION_METADATA];a.default(n,i.diffs)||i.applyDiffs(n,r,o)}})}else"getVariables"===t?(i.sendVariables(),o.socketClient.send("getContentResponse",{updated:!0})):"getActions"===t?o.socketClient.send("getContentResponse",{updated:!1}):"registerDevice"===t&&alert("Your device has been registered to "+e[0].email+".")},this.socketClient.onclose=function(){console.log("Leanplum: Disconnected to development server."),n=!1},this.socketClient.connect(this.socketHost),setInterval(function(){o.socketClient.connected||o.socketClient.connecting||o.socketClient.connect(o.socketHost)},5e3)}else console.log("Your browser doesn't support WebSockets.")},i.prototype.setSocketHost=function(t){this.socketHost=t},i.prototype.setNetworkTimeout=function(t){var e;this.networkTimeoutSeconds=t,null===(e=this.socketClient)||void 0===e||e.setNetworkTimeout(t)},i);function i(){this.networkTimeoutSeconds=10,this.socketClient=null,this.socketHost="dev.leanplum.com"}e.default=o},function(t,e,n){var s=n(35),a=n(10);t.exports=function t(e,n,r,o,i){return e===n||(null==e||null==n||!a(e)&&!a(n)?e!=e&&n!=n:s(e,n,r,o,t,i))}},function(t,e,n){var v=n(36),_=n(22),S=n(71),b=n(75),g=n(97),y=n(13),A=n(23),E=n(25),T="[object Object]",R=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,r,o,i){var s=y(t),a=y(e),u=s?"[object Array]":g(t),c=a?"[object Array]":g(e),l=(u="[object Arguments]"==u?T:u)==T,f=(c="[object Arguments]"==c?T:c)==T,p=u==c;if(p&&A(t)){if(!A(e))return!1;l=!(s=!0)}if(p&&!l)return i=i||new v,s||E(t)?_(t,e,n,r,o,i):S(t,e,u,n,r,o,i);if(!(1&n)){var d=l&&R.call(t,"__wrapped__"),h=f&&R.call(e,"__wrapped__");if(d||h)return o(d?t.value():t,h?e.value():e,n,r,i=i||new v)}return!!p&&(i=i||new v,b(t,e,n,r,o,i))}},function(t,e,n){var r=n(5),o=n(42),i=n(43),s=n(44),a=n(45),u=n(46);function c(t){var e=this.__data__=new r(t);this.size=e.size}c.prototype.clear=o,c.prototype.delete=i,c.prototype.get=s,c.prototype.has=a,c.prototype.set=u,t.exports=c},function(t,e){t.exports=function(){this.__data__=[],this.size=0}},function(t,e,n){var r=n(6),o=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=r(e,t);return!(n<0||(n==e.length-1?e.pop():o.call(e,n,1),--this.size,0))}},function(t,e,n){var r=n(6);t.exports=function(t){var e=this.__data__,n=r(e,t);return n<0?void 0:e[n][1]}},function(t,e,n){var r=n(6);t.exports=function(t){return-1<r(this.__data__,t)}},function(t,e,n){var o=n(6);t.exports=function(t,e){var n=this.__data__,r=o(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}},function(t,e,n){var r=n(5);t.exports=function(){this.__data__=new r,this.size=0}},function(t,e){t.exports=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}},function(t,e){t.exports=function(t){return this.__data__.get(t)}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e,n){var o=n(5),i=n(11),s=n(21);t.exports=function(t,e){var n=this.__data__;if(n instanceof o){var r=n.__data__;if(!i||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new s(r)}return n.set(t,e),this.size=n.size,this}},function(t,e,n){var r=n(17),o=n(51),i=n(19),s=n(20),a=/^\[object .+?Constructor\]$/,u=Function.prototype,c=Object.prototype,l=u.toString,f=c.hasOwnProperty,p=RegExp("^"+l.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!i(t)||o(t))&&(r(t)?p:a).test(s(t))}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var r=n(12),o=Object.prototype,i=o.hasOwnProperty,s=o.toString,a=r?r.toStringTag:void 0;t.exports=function(t){var e=i.call(t,a),n=t[a];try{var r=!(t[a]=void 0)}catch(t){}var o=s.call(t);return r&&(e?t[a]=n:delete t[a]),o}},function(t,e){var n=Object.prototype.toString;t.exports=function(t){return n.call(t)}},function(t,e,n){var r,o=n(52),i=(r=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";t.exports=function(t){return!!i&&i in t}},function(t,e,n){var r=n(0)["__core-js_shared__"];t.exports=r},function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e,n){var r=n(55),o=n(5),i=n(11);t.exports=function(){this.size=0,this.__data__={hash:new r,map:new(i||o),string:new r}}},function(t,e,n){var r=n(56),o=n(57),i=n(58),s=n(59),a=n(60);function u(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=i,u.prototype.has=s,u.prototype.set=a,t.exports=u},function(t,e,n){var r=n(8);t.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(t,e){t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},function(t,e,n){var r=n(8),o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(r){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return o.call(e,t)?e[t]:void 0}},function(t,e,n){var r=n(8),o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:o.call(e,t)}},function(t,e,n){var r=n(8);t.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=r&&void 0===e?"__lodash_hash_undefined__":e,this}},function(t,e,n){var r=n(9);t.exports=function(t){var e=r(this,t).delete(t);return this.size-=e?1:0,e}},function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},function(t,e,n){var r=n(9);t.exports=function(t){return r(this,t).get(t)}},function(t,e,n){var r=n(9);t.exports=function(t){return r(this,t).has(t)}},function(t,e,n){var o=n(9);t.exports=function(t,e){var n=o(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}},function(t,e,n){var r=n(21),o=n(67),i=n(68);function s(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new r;++e<n;)this.add(t[e])}s.prototype.add=s.prototype.push=o,s.prototype.has=i,t.exports=s},function(t,e){t.exports=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}},function(t,e){t.exports=function(t,e){return t.has(e)}},function(t,e,n){var r=n(12),f=n(72),p=n(16),d=n(22),h=n(73),v=n(74),o=r?r.prototype:void 0,_=o?o.valueOf:void 0;t.exports=function(t,e,n,r,o,i,s){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!i(new f(t),new f(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return p(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var a=h;case"[object Set]":var u=1&r;if(a=a||v,t.size!=e.size&&!u)return!1;var c=s.get(t);if(c)return c==e;r|=2,s.set(t,e);var l=d(a(t),a(e),r,o,i,s);return s.delete(t),l;case"[object Symbol]":if(_)return _.call(t)==_.call(e)}return!1}},function(t,e,n){var r=n(0).Uint8Array;t.exports=r},function(t,e){t.exports=function(t){var n=-1,r=Array(t.size);return t.forEach(function(t,e){r[++n]=[e,t]}),r}},function(t,e){t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}},function(t,e,n){var g=n(76),y=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,r,o,i){var s=1&n,a=g(t),u=a.length;if(u!=g(e).length&&!s)return!1;for(var c=u;c--;){var l=a[c];if(!(s?l in e:y.call(e,l)))return!1}var f=i.get(t);if(f&&i.get(e))return f==e;var p=!0;i.set(t,e),i.set(e,t);for(var d=s;++c<u;){var h=t[l=a[c]],v=e[l];if(r)var _=s?r(v,h,l,e,t,i):r(h,v,l,t,e,i);if(!(void 0===_?h===v||o(h,v,n,r,i):_)){p=!1;break}d=d||"constructor"==l}if(p&&!d){var S=t.constructor,b=e.constructor;S!=b&&"constructor"in t&&"constructor"in e&&!("function"==typeof S&&S instanceof S&&"function"==typeof b&&b instanceof b)&&(p=!1)}return i.delete(t),i.delete(e),p}},function(t,e,n){var r=n(77),o=n(79),i=n(82);t.exports=function(t){return r(t,i,o)}},function(t,e,n){var o=n(78),i=n(13);t.exports=function(t,e,n){var r=e(t);return i(t)?r:o(r,n(t))}},function(t,e){t.exports=function(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}},function(t,e,n){var r=n(80),o=n(81),i=Object.prototype.propertyIsEnumerable,s=Object.getOwnPropertySymbols,a=s?function(e){return null==e?[]:(e=Object(e),r(s(e),function(t){return i.call(e,t)}))}:o;t.exports=a},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,o=0,i=[];++n<r;){var s=t[n];e(s,n,t)&&(i[o++]=s)}return i}},function(t,e){t.exports=function(){return[]}},function(t,e,n){var r=n(83),o=n(92),i=n(96);t.exports=function(t){return(i(t)?r:o)(t)}},function(t,e,n){var l=n(84),f=n(85),p=n(13),d=n(23),h=n(88),v=n(25),_=Object.prototype.hasOwnProperty;t.exports=function(t,e){var n=p(t),r=!n&&f(t),o=!n&&!r&&d(t),i=!n&&!r&&!o&&v(t),s=n||r||o||i,a=s?l(t.length,String):[],u=a.length;for(var c in t)!e&&!_.call(t,c)||s&&("length"==c||o&&("offset"==c||"parent"==c)||i&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||h(c,u))||a.push(c);return a}},function(t,e){t.exports=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}},function(t,e,n){var r=n(86),o=n(10),i=Object.prototype,s=i.hasOwnProperty,a=i.propertyIsEnumerable,u=r(function(){return arguments}())?r:function(t){return o(t)&&s.call(t,"callee")&&!a.call(t,"callee")};t.exports=u},function(t,e,n){var r=n(7),o=n(10);t.exports=function(t){return o(t)&&"[object Arguments]"==r(t)}},function(t,e){t.exports=function(){return!1}},function(t,e){var r=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&r.test(t))&&-1<t&&t%1==0&&t<e}},function(t,e,n){var r=n(7),o=n(26),i=n(10),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,t.exports=function(t){return i(t)&&o(t.length)&&!!s[r(t)]}},function(t,e){t.exports=function(e){return function(t){return e(t)}}},function(t,s,a){(function(t){var e=a(18),n=s&&!s.nodeType&&s,r=n&&"object"==typeof t&&t&&!t.nodeType&&t,o=r&&r.exports===n&&e.process,i=function(){try{return r&&r.require&&r.require("util").types||o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=i}).call(this,a(24)(t))},function(t,e,n){var r=n(93),o=n(94),i=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return o(t);var e=[];for(var n in Object(t))i.call(t,n)&&"constructor"!=n&&e.push(n);return e}},function(t,e){var n=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||n)}},function(t,e,n){var r=n(95)(Object.keys,Object);t.exports=r},function(t,e){t.exports=function(e,n){return function(t){return e(n(t))}}},function(t,e,n){var r=n(17),o=n(26);t.exports=function(t){return null!=t&&o(t.length)&&!r(t)}},function(t,e,n){var r=n(98),o=n(11),i=n(99),s=n(100),a=n(101),u=n(7),c=n(20),l=c(r),f=c(o),p=c(i),d=c(s),h=c(a),v=u;(r&&"[object DataView]"!=v(new r(new ArrayBuffer(1)))||o&&"[object Map]"!=v(new o)||i&&"[object Promise]"!=v(i.resolve())||s&&"[object Set]"!=v(new s)||a&&"[object WeakMap]"!=v(new a))&&(v=function(t){var e=u(t),n="[object Object]"==e?t.constructor:void 0,r=n?c(n):"";if(r)switch(r){case l:return"[object DataView]";case f:return"[object Map]";case p:return"[object Promise]";case d:return"[object Set]";case h:return"[object WeakMap]"}return e}),t.exports=v},function(t,e,n){var r=n(2)(n(0),"DataView");t.exports=r},function(t,e,n){var r=n(2)(n(0),"Promise");t.exports=r},function(t,e,n){var r=n(2)(n(0),"Set");t.exports=r},function(t,e,n){var r=n(2)(n(0),"WeakMap");t.exports=r},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=r(n(14)),i=(s.prototype.connect=function(i){var a=this;a.connecting=!0,this.network.ajax("POST","https://"+i+"/socket.io/1","",function(t){var e=t.split(":"),n=e[0],r=parseInt(e[1])/2*1e3;a.socket=new WebSocket("wss://"+i+"/socket.io/1/websocket/"+n);var o=null;a.socket.onopen=function(){a.connected=!0,a.connecting=!1,a.onopen&&a.onopen(),o=setInterval(function(){a.socket.send("2:::")},r)},a.socket.onclose=function(){a.connected=!1,clearInterval(o),a.onclose&&a.onclose()},a.socket.onmessage=function(t){var e=t.data.split(":"),n=parseInt(e[0]);if(2===n)a.socket.send("2::");else if(5===n){var r=e[1],o=JSON.parse(e.slice(3).join(":")),i=o.name,s=o.args;r&&a.socket.send("6:::"+r),a.onmessage&&a.onmessage(i,s)}else 7===n&&console.log("Socket error: "+t.data)},a.socket.onerror=function(t){a.socket.close(),a.onerror&&a.onerror(t)}},null,!1,!0)},s.prototype.send=function(t,e){if(this.connected){var n=JSON.stringify({name:t,args:e});this.socket.send("5:::"+n)}else console.log("Leanplum: Socket is not connected.")},s.prototype.setNetworkTimeout=function(t){this.network.setNetworkTimeout(t)},s);function s(){this.network=new o.default,this.connected=!1,this.connecting=!1,this.connected=!1,this.connecting=!1}e.default=i},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,s,a,u){return new(a=a||Promise)(function(n,e){function r(t){try{i(u.next(t))}catch(t){e(t)}}function o(t){try{i(u.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(r,o)}i((u=u.apply(t,s||[])).next())})},a=this&&this.__generator||function(n,r){var o,i,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(s=2&e[0]?i.return:e[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,e[1])).done)return s;switch(i=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,i=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(n,a)}catch(t){e=[6,t],i=0}finally{o=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=o(n(15)),s=o(n(3)),u=o(n(1)),c=o(n(4)),l=(Object.defineProperty(f.prototype,"serviceWorker",{get:function(){return window.navigator.serviceWorker},enumerable:!0,configurable:!0}),f.prototype.isWebPushSupported=function(){var t;return Boolean(void 0!==(null===(t=window)||void 0===t?void 0:t.navigator)&&"serviceWorker"in window.navigator&&"PushManager"in window)},f.prototype.isWebPushSubscribed=function(){return r(this,void 0,void 0,function(){var e,n,r;return a(this,function(t){switch(t.label){case 0:return this.isWebPushSupported()?[4,this.getServiceWorkerRegistration()]:[2,!1];case 1:return(e=t.sent())?[4,e.pushManager.getSubscription()]:[2,!1];case 2:return n=t.sent(),(r=null!==n)&&this.updateNewSubscriptionOnServer(n),[2,r]}})})},f.prototype.register=function(i,s){return r(this,void 0,void 0,function(){var e,n,r,o;return a(this,function(t){switch(t.label){case 0:if(!this.isWebPushSupported())return console.log("Leanplum: Push messaging is not supported."),[2,s(!1)];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=this).serviceWorker.register(i||"/sw.min.js",null)];case 2:return e.serviceWorkerRegistration=t.sent(),n=this.serviceWorkerRegistration.pushManager.getSubscription(),(r=null!==n)&&this.updateNewSubscriptionOnServer(n),[2,s(r)];case 3:return o=t.sent(),console.log("Leanplum: Service Worker Error: ",o),[2,s(!1)];case 4:return[2]}})})},f.prototype.subscribeUser=function(){return r(this,void 0,void 0,function(){var e,n,r;return a(this,function(t){switch(t.label){case 0:e=this.urlB64ToUint8Array("BInWPpWntfR39rgXSP04pqdmEdDGa50z6zqbMvxyxJCwzXIuSpSh8C888-CfJ82WELl7Xe8cjAnfCt-3vK0Ci68"),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.serviceWorkerRegistration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:e})];case 2:if(!(n=t.sent()))throw new Error;return this.updateNewSubscriptionOnServer(n),[3,4];case 3:throw r=t.sent(),new Error("Leanplum: Failed to subscribe the user: "+r);case 4:return[2,!0]}})})},f.prototype.unsubscribeUser=function(){return r(this,void 0,void 0,function(){var e,n;return a(this,function(t){switch(t.label){case 0:return[4,this.isWebPushSubscribed()];case 1:if(!t.sent())return[3,6];t.label=2;case 2:return t.trys.push([2,5,,6]),[4,this.serviceWorkerRegistration.pushManager.getSubscription()];case 3:if(!(e=t.sent()))throw new Error;return[4,e.unsubscribe()];case 4:return t.sent(),[3,6];case 5:throw n=t.sent(),new Error("Leanplum: Error unsubscribing: "+n);case 6:return[2]}})})},f.prototype.getServiceWorkerRegistration=function(){return r(this,void 0,void 0,function(){var e;return a(this,function(t){switch(t.label){case 0:return this.serviceWorkerRegistration?[3,2]:[4,(e=this).serviceWorker.getRegistration()];case 1:e.serviceWorkerRegistration=t.sent(),t.label=2;case 2:return[2,this.serviceWorkerRegistration]}})})},f.prototype.urlB64ToUint8Array=function(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),n=this.decodeData(e),r=new Uint8Array(n.length),o=0;o<n.length;++o)r[o]=n.charCodeAt(o);return r},f.prototype.prepareSubscription=function(t){var e=Function.prototype.apply,n=t.getKey?t.getKey("p256dh"):"",r=t.getKey?t.getKey("auth"):"",o=this.encodeData(e.call(String.fromCharCode,null,new Uint8Array(n))),i=this.encodeData(e.call(String.fromCharCode,null,new Uint8Array(r)));return{endpoint:t.endpoint,key:o,auth:i}},f.prototype.updateNewSubscriptionOnServer=function(t){if(t){var e=this.prepareSubscription(t),n=JSON.stringify(e),r=c.default.getFromLocalStorage(u.default.DEFAULT_KEYS.PUSH_SUBSCRIPTION);i.default(r,n)||(c.default.saveToLocalStorage(u.default.DEFAULT_KEYS.PUSH_SUBSCRIPTION,n),this.setSubscription(n))}},f.prototype.setSubscription=function(t){if(t){var e=(new s.default).add(u.default.PARAMS.WEB_PUSH_SUBSCRIPTION,t);this.createRequest(u.default.METHODS.SET_DEVICE_ATTRIBUTES,e,{queued:!1,sendNow:!0})}},f.prototype.encodeData=function(t){return window.btoa(t)},f.prototype.decodeData=function(t){return window.atob(t)},f);function f(t){this.createRequest=t,this.serviceWorkerRegistration=null}e.default=l},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=r(n(3)),i=r(n(1)),s=r(n(4)),a=(u.prototype.applyDiffs=function(t,e,n){this.diffs=t,this.variants=e,this.actionMetadata=n,this.hasReceivedDiffs=!0,this.merged=function r(e,o){if("number"==typeof o||"boolean"==typeof o||"string"==typeof o)return o;if(null==o)return e;function t(r){return function(t){if(r instanceof Array)for(var e=0;e<r.length;e++)t(r[e]);else for(var n in r)!{}.hasOwnProperty.call(r,n)||t(n)}}var n=t(e),i=t(o),s=!1;if(null===e&&!(o instanceof Array))for(var a in s=null,o)if(o.hasOwnProperty(a)){if(null===s&&(s=!0),"string"!=typeof a){s=!1;break}if(a.length<3||"["!==a.charAt(0)||"]"!==a.charAt(a.length-1)){s=!1;break}}if(e instanceof Array||s){var u=[];return n(function(t){u.push(t)}),i(function(t){for(var e=parseInt(t.substring(1,t.length-1)),n=o[t];e>=u.length;)u.push(null);u[e]=r(u[e],n)}),u}var c={};return n(function(t){null!==o[t]&&void 0!==o[t]||(c[t]=e[t])}),i(function(t){c[t]=r(null===e?null:e[t]||{},o[t])}),c}(this.variables,t),this.saveDiffs(),this.onUpdate&&this.onUpdate()},u.prototype.loadDiffs=function(){try{this.applyDiffs(JSON.parse(this.loadLocal(i.default.DEFAULT_KEYS.VARIABLES)||null),JSON.parse(this.loadLocal(i.default.DEFAULT_KEYS.VARIANTS)||null),JSON.parse(this.loadLocal(i.default.DEFAULT_KEYS.ACTION_METADATA)||null)),this.token=this.loadLocal(i.default.DEFAULT_KEYS.TOKEN),this.variantDebugInfo=this.loadLocal(i.default.DEFAULT_KEYS.VARIANT_DEBUG_INFO)}catch(t){console.log("Leanplum: Invalid diffs: "+t)}},u.prototype.saveDiffs=function(){this.saveLocal(i.default.DEFAULT_KEYS.VARIABLES,JSON.stringify(this.diffs||{})),this.saveLocal(i.default.DEFAULT_KEYS.VARIANTS,JSON.stringify(this.variants||[])),this.saveLocal(i.default.DEFAULT_KEYS.ACTION_METADATA,JSON.stringify(this.actionMetadata||{})),this.saveLocal(i.default.DEFAULT_KEYS.VARIANT_DEBUG_INFO,JSON.stringify(this.variantDebugInfo||{})),this.saveLocal(i.default.DEFAULT_KEYS.TOKEN,this.token)},u.prototype.getVariable=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this.getVariables();if(n)for(var r=0;r<t.length;r++)n=n[t[r]];return n},u.prototype.getVariables=function(){return void 0!==this.merged?this.merged:this.variables},u.prototype.setVariables=function(t){this.variables=t},u.prototype.addVariablesChangedHandler=function(t){this.variablesChangedHandlers.push(t),this.hasReceivedDiffs&&t()},u.prototype.removeVariablesChangedHandler=function(t){var e=this.variablesChangedHandlers.indexOf(t);0<=e&&this.variablesChangedHandlers.splice(e,1)},u.prototype.triggerVariablesChangedHandlers=function(){for(var t=0;t<this.variablesChangedHandlers.length;t++)this.variablesChangedHandlers[t]()},u.prototype.getVariantDebugInfo=function(){return this.variantDebugInfo},u.prototype.setVariantDebugInfo=function(t){this.variantDebugInfo=t},u.prototype.sendVariables=function(){var t,e=((t={})[i.default.PARAMS.VARIABLES]=this.variables,t),n=(new o.default).body(JSON.stringify(e));this.createRequest(i.default.METHODS.SET_VARS,n,{sendNow:!0})},u.prototype.clearUserContent=function(){this.diffs=void 0,this.variables=null,this.variants=[],this.variantDebugInfo={},this.merged=void 0},u.prototype.loadLocal=function(t){return s.default.getFromLocalStorage(t)},u.prototype.saveLocal=function(t,e){s.default.saveToLocalStorage(t,e)},u);function u(t){this.createRequest=t,this.actionMetadata={},this.hasReceivedDiffs=!1,this.merged=void 0,this.variables=null,this.variablesChangedHandlers=[],this.variantDebugInfo={},this.diffs=void 0,this.token="",this.variants=[]}e.default=a}],o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=27);function o(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,o),e.l=!0,e.exports}var n,r});